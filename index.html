<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Music Player</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

  *, *::before, *::after {
    box-sizing: border-box;
  }

  html, body {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    background: transparent; /* ÏôÑÏ†Ñ Ìà¨Î™Ö */
    font-family: 'Press Start 2P', cursive;
  }

  body {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1em;
    min-height: 100vh;
    overflow: visible;
  }

  .player {
    width: 100%;
    max-width: 300px;
    background: rgba(26, 26, 26, 0.85);
    color: #ff0000;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 1em 1.5em;
    user-select: none;
    border-radius: 8px;
    box-shadow: 0 0 10px #ff0000aa;
  }

  .now-playing-container {
    text-align: center;
    color: white;
    text-shadow: 0 0 6px #ff0000;
    font-size: 0.5rem;
    line-height: 1.2;
  }
  #songTitle {
    display: block;
    font-size: 0.8rem;
    margin-top: 0.3em;
  }

  .progress-time {
    min-width: 3em;
    font-size: 0.5rem;
    user-select: none;
  }

  .progress-wrapper {
    display: flex;
    align-items: center;
    gap: 0.5em;
    margin-top: 0.8em;
  }

  .progress-container {
    flex-grow: 1;
    position: relative;
    height: 0.6em;
    background: rgba(255,0,0,0.15);
    border-radius: 0.3em;
    cursor: pointer;
  }

  .progress-bar {
    position: absolute;
    height: 90%;
    background: linear-gradient(90deg, white, red);
    width: 0%;
    border-radius: 0.3em;
  }

  .progress-thumb {
    position: absolute;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 1em;
    height: 1em;
    border: 0.15em solid #ff0000;
    border-radius: 50%;
    background: transparent;
    cursor: pointer;
  }

  .controls {
    display: flex;
    justify-content: center;
    gap: 1em;
    margin-top: 1em;
    align-items: center;
  }
  .controls button {
    background: transparent;
    border: none;
    font-size: 1rem; /* Î≤ÑÌäº ÌÅ¨Í∏∞ ÏÇ¥Ïßù Ï∂ïÏÜå */
    color: #ff0000;
    cursor: pointer;
    user-select: none;
    padding: 0;
    line-height: 1;
  }
  .controls button:focus {
    outline: none;
  }

  /* ÏùåÎüâ Î∞îÎ•º ÏùåÏÜåÍ±∞ Î≤ÑÌäº ÏòÜÏóê Í∞ÄÎ°ú Î∞∞Ïπò */
  .volume-container {
    width: 50px; /* ÏùåÎüâÎ∞î Í∏∏Ïù¥ 50px */
    height: 0.4em;
    display: inline-block;
  }
  .volume-slider {
    -webkit-appearance: none;
    width: 100%;
    height: 0.4em;
    border-radius: 0.2em;
    background: rgba(255, 0, 0, 0.3);
    cursor: pointer;
    outline: none;
  }
  .volume-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 1em;
    height: 1em;
    border-radius: 50%;
    background: #ff0000;
    cursor: pointer;
    border: none;
    margin-top: -0.3em;
  }
  .volume-slider::-moz-range-thumb {
    width: 1em;
    height: 1em;
    border-radius: 50%;
    background: #ff0000;
    cursor: pointer;
    border: none;
  }

  @media (max-width: 350px) {
    .player {
      padding: 0.75em 1em;
    }
    .now-playing-container {
      font-size: 0.85rem;
    }
    .controls button {
      font-size: 0.9rem;
    }
    .progress-time {
      font-size: 0.7rem;
      min-width: 2.5em;
    }
    .volume-container {
      width: 40px;
    }
  }
</style>
</head>
<body>

<div class="player" id="player">

  <div class="now-playing-container">
    Now Playing‚Ä¶
    <span id="songTitle"></span>
  </div>

  <div class="progress-wrapper">
    <div id="timeCurrent" class="progress-time">00:00</div>

    <div class="progress-container" id="progressContainer">
      <div class="progress-bar" id="progressBar"></div>
      <div class="progress-thumb" id="progressThumb"></div>
    </div>

    <div id="timeRemaining" class="progress-time">00:00</div>
  </div>

  <div class="controls">
    <button id="btnRepeat" title="Îã§Ïãú Îì£Í∏∞">üîÅ</button>
    <button id="btnPrev" title="Ïù¥Ï†Ñ Í≥°">‚èÆÔ∏è</button>
    <button id="btnPlay" title="Ïû¨ÏÉù/Ï†ïÏßÄ">‚ñ∂Ô∏è</button>
    <button id="btnNext" title="Îã§Ïùå Í≥°">‚è≠Ô∏è</button>
    <button id="btnMute" title="ÏùåÏÜåÍ±∞">üîà</button>
    <div class="volume-container">
      <input type="range" id="volumeSlider" class="volume-slider" min="0" max="1" step="0.01" value="1" />
    </div>
  </div>

</div>

<script>
  // Ïä§ÌÅ¨Î¶ΩÌä∏Îäî Î≥ÄÍ≤Ω ÌïÑÏöî ÏóÜÏúºÎãà Í∑∏ÎåÄÎ°ú ÎëêÏÑ∏Ïöî
  const playlist = [
    { src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3', title: 'ÎØºÎì§Î†à - Ïö∞Ìö®' },
    { src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3', title: 'ÎØºÎì§Î†à - Ïö∞Ìö®' },
    { src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3', title: 'ÎØºÎì§Î†à - Ïö∞Ìö®' }
  ];

  let currentIndex = 0;
  let isPlaying = false;
  let isRepeat = false;
  const audio = new Audio();
  audio.src = playlist[currentIndex].src;

  const btnPlay = document.getElementById('btnPlay');
  const btnRepeat = document.getElementById('btnRepeat');
  const btnPrev = document.getElementById('btnPrev');
  const btnNext = document.getElementById('btnNext');
  const btnMute = document.getElementById('btnMute');
  const progressBar = document.getElementById('progressBar');
  const progressThumb = document.getElementById('progressThumb');
  const progressContainer = document.getElementById('progressContainer');
  const timeCurrent = document.getElementById('timeCurrent');
  const timeRemaining = document.getElementById('timeRemaining');
  const songTitle = document.getElementById('songTitle');
  const volumeSlider = document.getElementById('volumeSlider');

  function formatTime(seconds) {
    if (isNaN(seconds)) return '00:00';
    const m = Math.floor(seconds / 60);
    const s = Math.floor(seconds % 60);
    return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
  }

  function updateNowPlaying() {
    songTitle.textContent = playlist[currentIndex].title;
  }

  function loadSong(index) {
    currentIndex = index;
    audio.src = playlist[currentIndex].src;
    audio.load();
    timeCurrent.textContent = '00:00';
    timeRemaining.textContent = '00:00';
    progressBar.style.width = '0%';
    progressThumb.style.left = '0px';
    updateNowPlaying();
    if(isPlaying) {
      audio.play();
      btnPlay.textContent = '‚è∏Ô∏è';
    } else {
      btnPlay.textContent = '‚ñ∂Ô∏è';
    }
  }

  audio.addEventListener('loadedmetadata', () => {
    timeRemaining.textContent = formatTime(audio.duration);
  });

  audio.addEventListener('timeupdate', () => {
    if(!isDragging) {
      const progressPercent = (audio.currentTime / audio.duration) * 100;
      progressBar.style.width = progressPercent + '%';
      const containerWidth = progressContainer.clientWidth;
      progressThumb.style.left = (containerWidth * progressPercent / 100) + 'px';

      timeCurrent.textContent = formatTime(audio.currentTime);
      timeRemaining.textContent = formatTime(audio.duration - audio.currentTime);
    }
  });

  audio.addEventListener('ended', () => {
    if(isRepeat) {
      audio.currentTime = 0;
      audio.play();
    } else {
      nextSong();
    }
  });

  btnPlay.addEventListener('click', () => {
    if(isPlaying) {
      audio.pause();
      btnPlay.textContent = '‚ñ∂Ô∏è';
    } else {
      audio.play();
      btnPlay.textContent = '‚è∏Ô∏è';
    }
    isPlaying = !isPlaying;
  });

  btnRepeat.addEventListener('click', () => {
    isRepeat = !isRepeat;
    btnRepeat.style.color = isRepeat ? '#fff000' : '#ff0000';
  });

  function prevSong() {
    currentIndex = (currentIndex - 1 + playlist.length) % playlist.length;
    loadSong(currentIndex);
  }
  btnPrev.addEventListener('click', prevSong);

  function nextSong() {
    currentIndex = (currentIndex + 1) % playlist.length;
    loadSong(currentIndex);
  }
  btnNext.addEventListener('click', nextSong);

  btnMute.addEventListener('click', () => {
    audio.muted = !audio.muted;
    btnMute.textContent = audio.muted ? 'üîá' : 'üîà';
    if(!audio.muted) {
      volumeSlider.value = audio.volume;
    }
  });

  volumeSlider.addEventListener('input', (e) => {
    audio.volume = e.target.value;
    audio.muted = false;
    btnMute.textContent = 'üîà';
  });

  progressContainer.addEventListener('click', (e) => {
    const rect = progressContainer.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const newTime = (clickX / rect.width) * audio.duration;
    audio.currentTime = newTime;
  });

  let isDragging = false;

  function onDragStart(e) {
    e.preventDefault();
    isDragging = true;
  }

  function onDragMove(e) {
    if(!isDragging) return;
    let clientX;
    if(e.type.startsWith('touch')) {
      clientX = e.touches[0].clientX;
    } else {
      clientX = e.clientX;
    }
    const rect = progressContainer.getBoundingClientRect();
    let posX = clientX - rect.left;
    posX = Math.min(Math.max(posX, 0), rect.width);
    const newTime = (posX / rect.width) * audio.duration;

    progressBar.style.width = (posX / rect.width) * 100 + '%';
    progressThumb.style.left = posX + 'px';
    timeCurrent.textContent = formatTime(newTime);
    timeRemaining.textContent = formatTime(audio.duration - newTime);
  }

  function onDragEnd(e) {
    if(!isDragging) return;
    let clientX;
    if(e.type.startsWith('touch')) {
      clientX = e.changedTouches[0].clientX;
    } else {
      clientX = e.clientX;
    }
    const rect = progressContainer.getBoundingClientRect();
    let posX = clientX - rect.left;
    posX = Math.min(Math.max(posX, 0), rect.width);
    const newTime = (posX / rect.width) * audio.duration;
    audio.currentTime = newTime;
    isDragging = false;
  }

  progressThumb.addEventListener('mousedown', onDragStart);
  window.addEventListener('mousemove', onDragMove);
  window.addEventListener('mouseup', onDragEnd);

  progressThumb.addEventListener('touchstart', onDragStart);
  window.addEventListener('touchmove', onDragMove);
  window.addEventListener('touchend', onDragEnd);

  loadSong(currentIndex);
</script>

</body>
</html>
